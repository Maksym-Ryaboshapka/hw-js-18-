async function e(){return await fetch("http://localhost:3000/movies").then(e=>e.json())}class t{constructor(e,t,n,o){this.title=e,this.genre=t,this.director=n,this.year=o}}async function n(e,n,o,i){return await fetch("http://localhost:3000/movies",{method:"POST",body:JSON.stringify(new t(e,n,o,i)),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(e=>e.json())}class o{constructor(e){this.modal=e}toggle(){this.modal.classList.toggle("is-hidden"),document.body.classList.toggle("no-scroll")}}const i=new o(document.querySelector(".add-modal"));document.querySelector("#add-movie").addEventListener("click",()=>i.toggle()),document.addEventListener("keydown",e=>{i.modal.classList.contains("is-hidden")||"Escape"!==e.code||i.toggle()});const a=new class{constructor(){this.list=document.querySelector(".movies")}createMarkup(e){let t=document.createElement("li");t.classList.add("movies__item"),t.id=e.id;let n=document.createElement("h2");n.classList.add("movies__title"),n.textContent=e.title;let o=document.createElement("p");o.classList.add("movies__genre"),o.textContent=e.genre;let i=document.createElement("p");i.classList.add("movies__director"),i.textContent=e.director;let a=document.createElement("p");a.classList.add("movies__year"),a.textContent=e.year;let s=document.createElement("button");s.textContent="Edit",s.classList.add("edit-movie"),s.id=e.id;let c=document.createElement("button");c.textContent="Delete",c.classList.add("delete-movie"),c.id=e.id,this.list.append(t),t.append(n,o,i,a,s,c)}async renderMovies(){(await e()).forEach(e=>{this.createMarkup(e)})}async renderAddedMovie(e,t,o,a){let s=await n(e,t,o,a);i.toggle(),this.createMarkup(s)}};async function s(e,n,o,i,a){return await fetch(`http://localhost:3000/movies/${e}`,{method:"PATCH",body:JSON.stringify(new t(n,o,i,a)),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(e=>e.json())}a.renderMovies(),document.querySelector(".add-form").addEventListener("submit",e=>{e.preventDefault();let t=e.target.children;a.renderAddedMovie(t.title.value,t.genre.value,t.director.value,t.year.value)});const c=new o(document.querySelector(".edit-modal"));async function d(e){return await fetch(`http://localhost:3000/movies/${e}`,{method:"DELETE"}).then(e=>e.json())}async function r(e){if(e.target.classList.contains("delete-movie")){let t=e.target.closest(".movies__item").id;await d(t),location.reload()}}document.addEventListener("click",function(t){if(t.target.classList.contains("edit-movie")){c.toggle();let n=t.target.closest(".movies__item").id;document.querySelector(".edit-form").addEventListener("submit",async t=>{t.preventDefault();let o=t.target.children,i=o.title.value,a=o.genre.value,c=o.director.value,d=o.year.value;if(i&&a&&c&&d)await s(n,i,a,c,d),location.reload();else{let t;(await e()).forEach(async e=>{if(e.id===n){t=e;let o={title:i||t.title,genre:a||t.genre,director:c||t.director,year:d||t.year};await s(n,o.title,o.genre,o.director,o.year),location.reload()}})}})}}),document.addEventListener("keydown",e=>{c.modal.classList.contains("is-hidden")||"Escape"!==e.code||c.toggle()}),document.addEventListener("click",r);
//# sourceMappingURL=index.0952654a.js.map
